<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ hàng - Lê Phú Quới</title>
    <link rel="stylesheet" href="../css/Home.css">
    <link rel="stylesheet" href="../css/Car.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body>
    <header>
        <h1>Giỏ hàng</h1>
    </header>
    <nav style="display:flex;align-items:center;justify-content:center;position:relative;">
        <div style="display:flex;gap:8px;justify-content:center;flex:1;">
            <a href="../Home.html">Trang chủ</a>
            <a href="About.html">Giới thiệu</a>
            <a href="Product.html">Sản phẩm</a>
            <a href="New.html">Tin tức</a>
            <a href="Contact.html">Liên hệ</a>
        </div>
        <span class="nav-account-cart" style="display:flex;align-items:center;gap:8px;position:absolute;right:10px;top:50%;transform:translateY(-50%);">
            <a href="Login.html" class="nav-account" title="Tài khoản" style="background:none;padding:0;margin:0;box-shadow:none;border:none;">
                <i class="fa fa-user" style="font-size:18px;color:#388e3c;"></i>
            </a>
            <a href="Car.html" class="nav-cart" title="Giỏ hàng" style="background:none;padding:0;margin:0;box-shadow:none;border:none;position:relative;">
                <i class="fa fa-shopping-cart" style="font-size:18px;color:#388e3c;"></i>
                <span id="cart-count">0</span>
            </a>
        </span>
    </nav>
    <div class="cart-container">
        <div class="cart-title">Giỏ hàng của bạn</div>
        <div id="cart-list"></div>
        <div class="cart-summary" id="cart-summary"></div>
        <div style="text-align:right">
            <button class="cart-checkout-btn" onclick="checkout()">Thanh toán</button>
        </div>
    </div>
    <div id="toast" class="toast"></div>
    <footer>
        &copy; 2025 Lê Phú Quới. All rights reserved.
    </footer>
    <script>
    // Danh sách sản phẩm mẫu (có thể lấy từ localStorage hoặc backend thực tế)
    const productImages = {
    'Phân bón': '../assets/1.jpg',
    'Hạt giống': '../assets/1.jpg',
    'Màng phủ nông nghiệp': '../assets/1.jpg',
    'Lưới che nắng': '../assets/1.jpg',
    'Dụng cụ làm vườn': '../assets/1.jpg',
    'Phân bón hữu cơ cao cấp': '../assets/1.jpg',
    'Phân NPK tổng hợp': '../assets/1.jpg',
    'Phân bón xuất khẩu': '../assets/1.jpg',
    'Phân bón hữu cơ 2': '../assets/1.jpg',
    'Phân NPK chuyên dụng': '../assets/1.jpg',
    'Phân bón hữu cơ 3': '../assets/1.jpg',
    'Dụng cụ làm vườn 95k': '../assets/1.jpg',
    'Phân bón xuất khẩu 1': '../assets/1.jpg',
    'Phân bón xuất khẩu 2': '../assets/1.jpg',
    'Phân bón xuất khẩu 3': '../assets/1.jpg',
    'Phân bón hữu cơ 1': '../assets/1.jpg',
    'Phân bón hữu cơ 4': '../assets/1.jpg',
    'Phân NPK 1': '../assets/1.jpg',
    'Phân NPK 2': '../assets/1.jpg',
    'Phân NPK 3': '../assets/1.jpg',
    'Dụng cụ làm vườn đa năng': '../assets/1.jpg',
    'Hạt giống cao cấp': 'img/1.jpg',
    'Màng phủ cao cấp': 'img/1.jpg'
    };
    const productPrices = {
    'Dụng cụ làm vườn đa năng': 120000,
    'Hạt giống cao cấp': 45000,
    'Lưới che nắng': 60000,
    'Phân bón': 120000,
    'Hạt giống': 35000,
    'Màng phủ nông nghiệp': 90000,
    'Lưới che nắng': 70000,
    'Dụng cụ làm vườn': 50000,
    'Phân bón hữu cơ cao cấp': 200000,
    'Phân NPK tổng hợp': 100000,
    'Phân bón xuất khẩu': 180000,
    'Phân bón xuất khẩu 1': 180000,
    'Phân bón xuất khẩu 2': 175000,
    'Phân bón xuất khẩu 3': 190000,
    'Phân bón hữu cơ 1': 120000,
    'Phân bón hữu cơ 2': 125000,
    'Phân bón hữu cơ 3': 130000,
    'Phân bón hữu cơ 4': 128000,
    'Phân NPK 1': 95000,
    'Phân NPK 2': 98000,
    'Phân NPK 3': 100000,
    'Phân NPK chuyên dụng': 150000,
    'Dụng cụ làm vườn 95k': 95000
    };
    function getCart() {
        return JSON.parse(localStorage.getItem('cart') || '{}');
    }
    function setCart(cart) {
        localStorage.setItem('cart', JSON.stringify(cart));
    }
    function updateCartCount() {
        var cart = getCart();
        var count = Object.values(cart).reduce((a,b) => a+b, 0);
        document.getElementById('cart-count').innerText = count;
    }
    function showToast(msg) {
        var toast = document.getElementById('toast');
        toast.innerText = msg;
        toast.classList.add('show');
        setTimeout(()=>toast.classList.remove('show'), 2000);
    }
    function changeQty(product, delta) {
        var cart = getCart();
        if(!cart[product]) return;
        cart[product] += delta;
        if(cart[product]<=0) delete cart[product];
        setCart(cart);
        renderCart();
        updateCartCount();
        showToast('Đã cập nhật số lượng!');
    }
    function removeFromCart(product) {
        var cart = getCart();
        if(cart[product]) {
            delete cart[product];
            setCart(cart);
            renderCart();
            updateCartCount();
            showToast('Đã xóa sản phẩm khỏi giỏ hàng!');
        }
    }
    function renderCart() {
        var cart = getCart();
        var keys = Object.keys(cart);
        var html = '';
        var total = 0;
        if(keys.length===0) {
            html = '<div class="cart-empty">Không có gì trong giỏ hàng của bạn.<br><a href=\"Product.html\" style=\"color:#388e3c;font-weight:bold;\">Tiếp tục mua sắm</a></div>';
            document.getElementById('cart-list').innerHTML = html;
            document.getElementById('cart-summary').innerHTML = '';
            return;
        }
        html += '<table class="cart-list">';
        html += '<tr><th></th><th>Sản phẩm</th><th>Đơn giá</th><th>Số lượng</th><th>Thành tiền</th><th></th></tr>';
        keys.forEach(function(item, idx){
            var price = productPrices[item]||0;
            var qty = cart[item];
            var img = productImages[item]||'';
            var subtotal = price*qty;
            total += subtotal;
                html += '<tr style="animation-delay:'+(idx*0.07)+'s">'+
                    '<td><img src="'+img+'" class="cart-img"></td>'+
                    '<td>'+item+'</td>'+
                    '<td>'+price.toLocaleString('vi-VN')+' đ</td>'+
                    '<td class="cart-qty">'+
                        '<button class="cart-qty-btn" onclick="changeQty(\''+item+'\',-1)">-</button>'+
                        '<span class="cart-qty-value">'+qty+'</span>'+
                        '<button class="cart-qty-btn" onclick="changeQty(\''+item+'\',1)">+</button>'+
                    '</td>'+
                    '<td>'+(subtotal).toLocaleString('vi-VN')+' đ</td>'+
                    '<td><button class="cart-remove" onclick="removeFromCart(\''+item+'\')"><i class="fa fa-trash"></i></button></td>'+
                '</tr>';
        });
        html += '</table>';
        document.getElementById('cart-list').innerHTML = html;
        document.getElementById('cart-summary').innerHTML = '<strong>Tổng cộng: '+total.toLocaleString('vi-VN')+' đ</strong>';
        // Thêm hiệu ứng fade-in cho từng dòng
        setTimeout(()=>{
            document.querySelectorAll('.cart-list tr').forEach(tr=>tr.classList.add('animated'));
        }, 10);
    }
    function checkout() {
        window.location.href = "Payment.html";
    }
    updateCartCount();
    renderCart();
    </script>
</body>
</html>
